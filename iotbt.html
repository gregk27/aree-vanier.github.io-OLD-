<style>
  body{
  background-color:#a0a0a0;
  font-family:sans-serif;
  padding-left:2%;
  min-width:670px;
}
header{
  width:100%;
  background-color:red;
}
h1{
  background-color:black;
  color:white;
  padding:10px;
  margin-left:3%;
}

h2{
  background-color:#3f3f3f;
  color:white;
  padding:2px;
  width:25%;
}

p{
  margin-left:4%;
}

</style>

<header>
  <h1>
    IoT Blockchain Technologies
  </h1>
</header>

<h2>Alert Array</h2> 
<p>
The Alert Array allows peace of mind for the families of the elderly, who need reminders of when to take their pills. If the Array detects that the pills have not been taken, it will actuate a vibration motor, notifying the user that they need to be taken.
<br/><br/>
The Alert Array uses Internet of Things design principles combined with a centralised blockchain to consistenly monitor the status of the users pills
</p>

<h2>Cost</h2>
<p>
The Array Alert system is cheap when compared to competing systems
<br/><br/>
1 Base + 3 Sensors : 150$
<br/>
Additional Sensor : 100$
<br/>
Battery Replacement : 80$
<br/><br/>

Along with these products, there is a 20$ subscription fee to recieve system updates
</p>
<h2>Contact us!</h2>
<p>
Don't.
</p>

let setModeFlag = false
let baseCount = 0
let counter = 0
let b = false
let a = false
radio.onReceivedNumber(function (receivedNumber) {
    val = val | receivedNumber;
    basic.showNumber(val)
})
function notify2() {
    let err = base ^ val;
    if (err == 0) {
        basic.showIcon(IconNames.Heart)
        return;
    }
    basic.showNumber(err)
    for (let i = 0; i < 100 * err; i++) {
        servos.turnLeftServo(90);
        basic.pause(1);
        servos.turnLeftServo(-90);
        basic.pause(1);
    }

}
function setMode2() {
    a = input.buttonIsPressed(Button.A)
    b = input.buttonIsPressed(Button.B)
    if (baseCount == -1) {
        basic.showIcon(IconNames.No)
    }
    if (counter >= 2) {
        if (a && b) {
            setModeFlag = false
            init()
            basic.showIcon(IconNames.Yes)
            // files.settingsSaveNumber("count", baseCount)
        } else if (a) {
            baseCount += -1
            if (baseCount <= 0) {
                baseCount = 0
            }
            basic.showNumber(baseCount)
        } else if (b) {
            baseCount += 1
            basic.showNumber(baseCount)
        }
        counter = 0
    }
    if (a || b) {
        counter += 1
    } else {
        counter = 0
    }
}
function init() {
    base = 2 ** (baseCount + 1) - 1
    val = 2 ** baseCount
}
let val = 0b0;
let base = 0b0;
baseCount = -1;
init();

radio.setGroup(1)
// let foo = files.open("data.txt");
// foo.read();

// if (files.settingsReadNumber("count") == -1) {
//     setModeFlag = true
// } else {
//     basic.showNumber(files.settingsReadNumber("count"))
// }

setModeFlag = true;

basic.forever(function () {
    if (setModeFlag) {
        setMode2()
        return;
    }
    // counter += 1
    // if (counter == 100) {
    if (input.buttonIsPressed(Button.A) || input.buttonIsPressed(Button.B))
        notify2()
    if (input.buttonIsPressed(Button.AB))
        init()
    // counter = 0
    // }
})

